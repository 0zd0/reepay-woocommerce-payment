{"version":3,"sources":["thankyou.js"],"names":["jQuery","$","window","wc_reepay_thankyou","xhr","attempts","init","this","checkPayment","err","data","status_elm","success_elm","failed_elm","state","hide","show","append","message","setTimeout","callback","block","WC_Reepay_Thankyou","check_message","overlayCSS","background","opacity","ajax","type","url","ajax_url","action","nonce","order_id","order_key","dataType","always","unblock","done","response","document","ready"],"mappings":"AAAAA,QAAQ,SAAUC,GACd,aAEAC,OAAOC,mBAAqB,CACxBC,KAAK,EACLC,SAAU,EAKVC,KAAM,WACFC,KAAKC,cAAc,SAAWC,EAAKC,GAC/B,IAAIC,EAAaV,EAAG,0BAChBW,EAAcX,EAAG,kBACjBY,EAAaZ,EAAG,iBAEpB,OAASS,EAAKI,OACV,IAAK,OACDH,EAAWI,OACXH,EAAYI,OACZ,MACJ,IAAK,SACL,IAAK,UACDL,EAAWI,OACXF,EAAWI,OAAQ,gCAAkCP,EAAKQ,QAAU,QACpEL,EAAWG,OACX,MACJ,QAGI,GAFAd,OAAOC,mBAAmBE,WAErBH,OAAOC,mBAAmBE,SAAW,EACtC,OAGJc,YAAW,WACPjB,OAAOC,mBAAmBG,SAC3B,UASnBE,aAAc,SAAWY,GASrB,OARAnB,EAAG,sBAAuBoB,MAAO,CAC7BH,QAASI,mBAAmBC,cAC5BC,WAAY,CACRC,WAAY,OACZC,QAAS,MAIVzB,EAAE0B,KAAM,CACXC,KAAM,OACNC,IAAKP,mBAAmBQ,SACxBpB,KAAM,CACFqB,OAAQ,uBACRC,MAAOV,mBAAmBU,MAC1BC,SAAUX,mBAAmBW,SAC7BC,UAAWZ,mBAAmBY,WAElCC,SAAU,SACVC,QAAQ,WACRnC,EAAG,sBAAuBoC,aAC1BC,MAAM,SAAWC,GACjBnB,EAAU,KAAMmB,EAAS7B,WAKrCT,EAAEuC,UAAUC,OAAO,WACfvC,OAAOC,mBAAmBG","file":"thankyou.min.js","sourcesContent":["jQuery( function( $ ) {\r\n    'use strict';\r\n\r\n    window.wc_reepay_thankyou = {\r\n        xhr: false,\r\n        attempts: 0,\r\n\r\n        /**\r\n         * Initialize the checking\r\n         */\r\n        init: function() {\r\n            this.checkPayment( function ( err, data ) {\r\n                var status_elm = $( '#order-status-checking' ),\r\n                    success_elm = $( '#order-success' ),\r\n                    failed_elm = $( '#order-failed' );\r\n\r\n                switch ( data.state ) {\r\n                    case 'paid':\r\n                        status_elm.hide();\r\n                        success_elm.show();\r\n                        break;\r\n                    case 'failed':\r\n                    case 'aborted':\r\n                        status_elm.hide();\r\n                        failed_elm.append( '<p class=\"transaction-error\">' + data.message + \"</p>\" );\r\n                        failed_elm.show();\r\n                        break;\r\n                    default:\r\n                        window.wc_reepay_thankyou.attempts++;\r\n\r\n                        if ( window.wc_reepay_thankyou.attempts > 6) {\r\n                            return;\r\n                        }\r\n\r\n                        setTimeout(function () {\r\n                            window.wc_reepay_thankyou.init();\r\n                        }, 10000);\r\n                }\r\n            } );\r\n        },\r\n\r\n        /**\r\n         * Check payment\r\n         * @return {JQueryPromise<any>}\r\n         */\r\n        checkPayment: function ( callback ) {\r\n            $( '.woocommerce-order' ).block( {\r\n                message: WC_Reepay_Thankyou.check_message,\r\n                overlayCSS: {\r\n                    background: '#fff',\r\n                    opacity: 0.6\r\n                }\r\n            } );\r\n\r\n            return $.ajax( {\r\n                type: 'POST',\r\n                url: WC_Reepay_Thankyou.ajax_url,\r\n                data: {\r\n                    action: 'reepay_check_payment',\r\n                    nonce: WC_Reepay_Thankyou.nonce,\r\n                    order_id: WC_Reepay_Thankyou.order_id,\r\n                    order_key: WC_Reepay_Thankyou.order_key,\r\n                },\r\n                dataType: 'json'\r\n            } ).always( function() {\r\n                $( '.woocommerce-order' ).unblock();\r\n            } ).done( function ( response ) {\r\n                callback( null, response.data );\r\n            } );\r\n        },\r\n    };\r\n\r\n    $(document).ready( function () {\r\n        window.wc_reepay_thankyou.init();\r\n    } );\r\n} );\r\n"]}